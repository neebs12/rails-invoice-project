<h1>Invoices Here</h1>

<%# buttons %>
<ul>
  <li><%= button_to "(+ New Invoice)", new_invoice_path, method: :get %></li>
  <li><%= button_to "(+ New Client)", new_client_path, method: :get %></li>
</ul>

<%# list the invoices beneath this line %>
<table>
  <tr>
    <th>Invoice no.</th>
    <th>Client Email</th>
    <th>Invoice Total</th>
    <th>Buttons</th>
  </tr>
  <% @invoices.each do |invoice|%>
    <tr>
      <th>
        <%= link_to "INV_#{invoice.id}", invoice_path(invoice) %>
      </th>
      <th>
        <%= invoice.client.email %>
      </th>
      <th>
        <% total = 0 %>
        <% invoice.invoice_items.each do |item| %>
          <% quantity = item.quantity %>
          <% price = item.price %>
          <% total += (quantity * price) %>
        <% end %>
        <%= total %>
      </th>
      <th><button type="button">üìù</button>
      <%= button_to "üóëÔ∏è", invoice_path(invoice), method: :delete, data: {
        turbo_confirm: "Are you sure you want to delete this invoice?",
      } %>
      <%= button_to "‚òÅÔ∏è", send_by_client_email_path(invoice), method: :post, data: {
        turbo_confirm: "Are you sure you want to EMAIL‚òÅÔ∏è this invoice?",
      }, params: {
        email: invoice.client.email,
        url: private_show_path(invoice)
      } %>
      </th>

    </tr>
  <% end %>
</table>